<!-- help-modal.html -->
<div id="help-modal" class="help-overlay" aria-hidden="true">
  <div class="help-box" role="document">
    <button class="help-close" aria-label="Close help">&times;</button>
    <div class="help-content">
        <h1 align="center">Help, clarifications and best practice</h1><p>
        <h4>Buttons & getting started:</h4>
        <small class="muted-small">More comprehensive Documentation at .../pgm/documentation (outdated)</small>
        <ul>
            <li>
                <strong>Continue</strong>:<br>
                <em>Without story</em> present it will start a new one.<br>
                <em>Without an action</em> entered it will continue from the last paragraph.<br>
                <em>With an action</em> entered it will resolve that action.<p>
            </li>
            <li>
                <strong>Re-Do</strong>:<br>
                Remove and re-do the last paragraph.<p>
            </li>
        </ul>

        <h4>Troubleshooting</h4>
        <ul>
            <li>
                <strong>LLM is stuck/repeats an old paragraph:</strong>:<br>
                It does that because it is very tightly leashed to not run any idiotic story it can dream up.<br>
                The downside is that sometimes it doesn't know how to advance or thinks it needs to restate for ... reasons.<br>
                Should only happen, if you excessively click continue without acting.<br>
                Or if you take actions that create a loop without exit like "I keep watching the clouds."<br>
                You need to break out with an action (and it's probably best to remove the "stuck" parts.)"<br>
                Try "I keep watching the clouds until it's time to leave."<p>
            </li>
            <li>
                <strong>LLM generated paragraph is "insane" or nonsensical</strong>:<br>
                The GM probably crapped out. Hover your action and read the Outcome.
                There are various possible faults here: Generally the issue is too much or too little text.<br>
                Most commonly it probably misunderstood you or the action is too complex.<br>
                Currently observing if it fully fails on partial failure...
                Try to phrase your action differently.<p>
            </li>
            <li>
                <strong>Direct speech is messed up</strong>:<br>
                (Unconfirmed). Quotes are for direct speech and nothing else. Don't use quotes for nicknames or so. It seems to do okay with 'Nickname' but its not specifically told what 'bla' means.<p>
            </li>
            <li>
                <strong>Rules</strong>:<br>
                If, else, are all understood. Keep it relatively simple and generalize.<br>
                Only once the player character has 10 long term memories of winning fights: Introduce the main antagonist.<br>
                Is that 100% fireproof? No.<p>
            </li>
        </ul>

        <h4>Editable "memory" fields: Story History + Mid-Term + Long-Term</h4>
        <ul>
            <li>
                Edit/Add to correct tone, fix details, or remove unwanted events. Edits are passed to the DB on button click and respected in generations.<p>
            </li>
            <li>
                <strong>Story History</strong>:<br>
                "Short-term" memory: Changing text outside the budget will be passed to DB but not be respected in prompts - unless the memory pipeline includes it in its summary, but it's not guaranteed."<p>
            </li>
            <li>
                <strong>Mid-Term</strong>:<br>
                Rolling window/conveyor belt: Edit as needed.<p>
            </li>
            <li>
                <strong>Long-Term</strong>:<br>
                Shows all long-term memories: Edit as needed.<br>
                Some of these (until we hit budget) are chosen for the LLM prompt based on tag weighted relevance scoring. Removing some bullet points might therefore create a tag mismatch (not that dramatic in the end) but you might consider removing a full "set" of bullet points instead.<br>Same goes for adding stuff. Choose one that fits the "theme".<br>
            </li>
        </ul>
    </div>
  </div>
</div>

<style>
#help-modal li { color: #f6f3ec; font-size: 1rem; line-height: 1.6; }

#help-modal h1, h2, h3, h4, h5, h6 {
  font-size: 1.1rem;
  color: #ffd96b;
  font-weight: 1000;
  line-height: 1.2;
  margin: 0 0 0.5rem 0;
}

#help-modal strong {
  font-size: 1.1rem;
  font-weight: 1000;
  color: #ffd96b;
  padding-top: 12px;
  padding-bottom: 0.5rem;
}

.code-indent { font-size: 0.9rem; padding-left: 1.5rem; padding-top: 0.5rem; padding-bottom: 0.5rem; }
.code-indent code { display: inline-block; }
.code-indent2 { font-size: 0.9rem; padding-left: 1.5rem; padding-bottom: 0.5rem; }
.code-indent2 code { display: inline-block; }

.help-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1200;
}

.help-overlay.open {
  display: flex;
}

.help-box {
  background: #0f1724;
  color: #fff;
  border-radius: 8px;
  width: min(800px, 92%);
  max-height: 86vh;
  overflow: auto;
  padding: 20px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  position: relative;
}

.help-close {
  position: absolute;
  top: 12px;
  right: 12px;
  background: transparent;
  color: #fff;
  border: none;
  font-size: 22px;
  cursor: pointer;
}
</style>
